<!DOCTYPE html> <!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]--> <!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]--> <!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]--> <head> <meta charset="utf-8"> <title>@Lenciel</title> <meta name="author" content="Lenciel Li"> <meta name="description" content="昨天饭局上聊起来自动化测试或者是别的奇怪事业里经常需要面对的一个问题：验证码识别。 其实验证码的识别，技术上来说可以作为古老的OCR（Optical Character Recognition）问题的一个子集：因为OCR其实就是从图片上把文字认出来嘛。 但它的有趣之处在于，验证码， &hellip;"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="canonical" href="https://lenciel.com"> <link href="/favicon.png" rel="icon"> <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css"> <script src="/javascripts/libs/modernizr.custom.55630.js"></script> <script src="/javascripts/ender.js"></script> <script src="/javascripts/libs/jquery.min.js"></script> <script src="/javascripts/octopress.js" type="text/javascript"></script> <link href="http://feeds.feedburner.com/github/lenciel" rel="alternate" title="@Lenciel" type="application/atom+xml"> <meta property="og:type" content="article"/> <meta property="og:url" content="https://lenciel.com"/> <meta property="og:description" content="昨天饭局上聊起来自动化测试或者是别的奇怪事业里经常需要面对的一个问题：验证码识别。 其实验证码的识别，技术上来说可以作为古老的OCR（Optical Character Recognition）问题的一个子集：因为OCR其实就是从图片上把文字认出来嘛。 但它的有趣之处在于，验证码， &hellip;"/> <meta property="og:site_name" content="https://lenciel.com"/> <meta property="article:author" content="https://lenciel.com"> <meta itemprop="description" content="昨天饭局上聊起来自动化测试或者是别的奇怪事业里经常需要面对的一个问题：验证码识别。 其实验证码的识别，技术上来说可以作为古老的OCR（Optical Character Recognition）问题的一个子集：因为OCR其实就是从图片上把文字认出来嘛。 但它的有趣之处在于，验证码， &hellip;"/> <script type="text/javascript">
  var host = "lenciel.com";
  if ((host == window.location.host) && (window.location.protocol != "https:"))
    window.location.protocol = "https";
</script> <script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?42345b94bf173b38bef61f873677adfa";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-175991-7', 'auto');
  ga('send', 'pageview');

</script> </head> <body class="collapse-sidebar sidebar-footer"> <header role="banner"><hgroup> <h1><a href="/">@Lenciel</a></h1> <h2>Thoughts and Rants.</h2> </hgroup> </header> <nav role="navigation"><ul class="subscription" data-subscription="rss"> <li><a href="http://feeds.feedburner.com/github/lenciel" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li> </ul> <form action="https://google.com/search" method="get"> <fieldset role="search"> <input type="hidden" name="sitesearch" value="lenciel.com"> <input class="search" type="text" name="q" results="0" placeholder="Search"/> </fieldset> </form> <ul class="main-navigation"> <li><a href="/"><i class="icon-home"></i>Home</a></li> <li><a href="/blog/archives"><i class="icon-book-alt"></i>Archives</a><span class="divider"></span></li> <li><a href="/about"><i class="icon-user"></i>About</a><span class="divider"></span></li> </ul> </nav> <div id="main"> <div id="content"> <div class="blog-index"> <article> <header> <h1 class="entry-title"><a href="/2016/06/python-captcha-solution/">简单验证码的快速识别</a></h1> <p class="meta"> <time class='entry-date' datetime='2016-06-16T18:48:14+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>6:48 pm</span></time> | <a href="/2016/06/python-captcha-solution/#disqus_thread" data-disqus-identifier="https://lenciel.com/2016/06/python-captcha-solution/">Comments</a> </p> </header> <div class="entry-content"><p>昨天饭局上聊起来自动化测试或者是别的奇怪事业里经常需要面对的一个问题：验证码识别。</p> <p>其实验证码的识别，技术上来说可以作为古老的OCR（Optical Character Recognition）问题的一个子集：因为OCR其实就是从图片上把文字认出来嘛。</p> <p>但它的有趣之处在于，验证码，也就是CAPTCHA，本身就是&#8217;Completely Automated Public Turing test to tell Computers and Humans Apart&#8217;的缩写，也就是说在设计上它的目的就是要：</p> <ol> <li>让人很容易认识出来</li> <li>让机器很难认识出来</li> </ol> <p>所以如果你电脑识别出来了验证码，要么就是它特别容易不符合#2的要求，要么就是你实现了很不错的人工智能算法，这篇文章是讲第一种情况。</p> <p>传统的做法来识别OCR，主要需要处理的是下面三个环节：</p> <ol> <li>图片二值化</li> <li>字符的分割</li> <li>字符的识别</li> </ol> <a name="L.................."></a> <h3>二值化怎么做</h3> <p>所谓的“二值化”，就是图片上的像素要么灰度是255（白），要么是0（黑）。大致的思路就是把灰度大于或等于阈值的像素判为属于你关注的文字，置成0；其他的像素点灰度置为255。</p> <p>具体的操作，我一般使用下面几种方式：</p> <ol> <li>如果是特别简单地处理，用PIL库</li> <li>如果是比较复杂的但是不需要很细致的控制，用<a href="http://imagemagick.sourceforge.net/">ImageMagick</a>的<code>convert</code>命令</li> <li>如果是特别复杂，需要反复试验各种算法的，用OpenCV</li> </ol> <p>所以下面这两个验证码，哪个的难度大一些？</p> <p style="font-size: 0.8em; "><img src="/downloads/images/2016_06/orig_code.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"><br/> 图1. 微林的验证码</p> <p style="font-size: 0.8em; "><img src="/downloads/images/2016_06/orig_code_2.jpg" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"><br/> 图2. 饭局后J.Snow提供的验证码</p> <p>如果你脑子里面没有二值化的概念大概会觉得第一个难度大一些，因为以人眼的视线去考虑，好像第一张要“难分辨”一些。</p> <p>但其实第一张图所有的噪声都是花花绿绿的颜色，而验证码本身是纯粹的黑色，这种图片处理起来是相对容易的。只需要找到验证码像素点的颜色，用这种颜色选取这些像素点，拷贝到一张全白的图片上面即可。</p> <p>要获取验证码的像素颜色可以<a href="http://www.boyter.org/decoding-captchas/">参考这里</a>的思路，把图片转成256色的，然后对所有的像素做一个统计然后标出它们在整个图片里面出现的频率。因为觉得原文里面的代码写得比较啰嗦（要学会写lamda啊）就做了一些修改：</p> <figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">get_top_pixels</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">min_pt_num</span><span class="p">):</span>
</span><span class='line'>    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span class='line'>    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s">&quot;P&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">top_pixels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">histogram</span><span class="p">()):</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">min_pt_num</span><span class="p">):</span>
</span><span class='line'>            <span class="n">top_pixels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">top_pixels</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="n">get_top_pixels</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure> <p>这个程序运行的结果如下：</p> <blockquote><p>$ python get_histdata.py regcode.png 30</p><p>[(0, 1471), (1, 214), (10, 110), (11, 97), (2, 85), (9, 83), (6, 66), (8, 58), (7, 49), (5, 37)]</p></blockquote> <p>拿到了颜色，就可以写一个简单的程序从图片里面拷贝这些像素到一张干净的图：</p> <figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">clean_image</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">key_pix</span><span class="p">):</span>
</span><span class='line'>    <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span class='line'>    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s">&quot;P&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">im2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;P&quot;</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span class='line'>            <span class="n">pix</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span><span class='line'>            <span class="c"># color of pixel to get</span>
</span><span class='line'>            <span class="k">if</span> <span class="n">pix</span> <span class="o">==</span> <span class="n">key_pix</span><span class="p">:</span>
</span><span class='line'>                <span class="n">im2</span><span class="o">.</span><span class="n">putpixel</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">im2</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;convert_</span><span class="si">%s</span><span class="s">.png&quot;</span> <span class="o">%</span> <span class="n">key_pix</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">clean_image</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure> <p>出现的最多的<code>0</code>显然是背景色，所以对<code>1</code>和<code>10</code>运行脚本：</p> <blockquote><p>$ python convert_grayscale.py regcode.png 1<br/>$ python convert_grayscale.py regcode.png 10</p></blockquote> <p>结果如下：</p> <p><img src="/downloads/images/2016_06/convert_1.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true">&nbsp;&nbsp;&nbsp;&nbsp;<img src="/downloads/images/2016_06/convert_10.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"></p> <p>很明显目标像素是1而不是10。</p> <p>而J. Snow的这张图，首先验证码本身就是幻彩的而不是均匀一致的颜色，然后噪声又都是用这些幻彩颜色来生成的，所以如果只是简单的对颜色排序，会得到下面的结果：</p> <blockquote><p>[(225, 349), (139, 170), (182, 161), (219, 95), (224, 64), (189, 54), (175, 47), (218, 40), (90, 36), (96, 33)]</p></blockquote> <p>然后我们对排名靠前的像素进行提取会得到下面的结果：</p> <p><img src="/downloads/images/2016_06/convert_225.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"><img src="/downloads/images/2016_06/convert_139.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"><img src="/downloads/images/2016_06/convert_182.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"><img src="/downloads/images/2016_06/convert_219.png" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"></p> <p>这种情况下怎么办？直观观察一下验证码，会发现背景噪声点相比验证码像素点来说很少（这也正常，都是一个颜色如果太多就没法看了）， 很适合先做一些切割，然后进行模糊匹配（因为验证码的像素是幻彩的不是单一的，需要匹配相近像素点），然后再做二值化。</p> <p>直接用IM的convert来处理比写代码简单：</p> <figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>convert 1.pic.jpg -gravity Center -crop 48x16+0+0  +repage -fuzz 50% -fill white -opaque white -fill black +opaque white resultimage.jpg
</span></code></pre></td></tr></table></div></figure> <p>效果如下：</p> <p><img src="/downloads/images/2016_06/orig_code_2.jpg" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true">&nbsp;&nbsp;&nbsp;&nbsp;<img src="/downloads/images/2016_06/convert_im.jpg" title="Don't touch me..." alt="Vhost threshold" data-pin-nopin="true"></p> <a name="L.................."></a> <h3>字符怎么分割</h3> <p>其实整个验证码的识别里面，最难的是分割。特别是很多严肃的验证码，字体不是标准字体或者会变形，互相还可能粘连或者重叠，分割起来是非常难的。</p> <p>但这里拿到的验证码相对简单，这部分不是问题就不展开了。</p> <a name="L..............."></a> <h3>字符的识别</h3> <p>对于这里拿到的验证码而言，因为都是标准字体，可以直接使用OCR的开源工具读取，比如<a href="https://github.com/tesseract-ocr/tesseract/wiki">tesseract</a>：</p> <figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>tesseract resultimage.jpg -psm <span class="m">7</span> output <span class="o">&amp;&amp;</span> cat output.txt
</span><span class='line'>
</span><span class='line'>Tesseract Open Source OCR Engine v3.04.01 with Leptonica
</span><span class='line'>Warning in pixReadMemJpeg: work-around: writing to a temp file
</span><span class='line'>
</span><span class='line'>YLNU
</span></code></pre></td></tr></table></div></figure> <p>如果不是标准字体的，因为分割完毕了就拿到了独立的字符，要识别就可以建一个模型，不断的训练它，来识别每个字符。</p> <a name="L..........................."></a> <h3>如果是更困难的呢？</h3> <p>可能你会觉得围棋电脑都会下了，那么认识验证码为什么还是比较难？</p> <p>其实<a href="https://www.google.com.hk/search?safe=off&amp;q=CNN+captcha&amp;oq=CNN+captcha&amp;gs_l=serp.3...1563.1932.0.2169.3.3.0.0.0.0.0.0..0.0....0...1c.1.64.serp..3.0.0.q4EdDQLrqyk">随便搜一下</a>就会发现有很多人在做这方面的实验，主要的思路就是把n个字符组成的验证码当成有n个标签的图片来用CNN来解决。加上最近很多大公司开放了自己的人工智能平台，比如Google的Tensorflow，我们这些没有大量计算资源的普通人也可以用它们实现自己的想法了。</p> <p>推荐参考链接：</p> <ol> <li><a href="https://matthewearl.github.io/2016/05/06/cnn-anpr/">CNN辨认车牌</a></li> <li><a href="http://www.cs.sjsu.edu/faculty/pollett/masters/Semesters/Spring15/geetika/CS298%20Slides%20-%20PDF">CNN验证码识别</a></li> </ol> </div> </article> <article> <header> <h1 class="entry-title"><a href="/2016/05/starry-starry-night/">Starry Starry Night</a></h1> <p class="meta"> <time class='entry-date' datetime='2016-05-19T13:57:30+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:57 pm</span></time> | <a href="/2016/05/starry-starry-night/#disqus_thread" data-disqus-identifier="https://lenciel.com/2016/05/starry-starry-night/">Comments</a> </p> </header> <div class="entry-content"><p><img src="/downloads/images/2016_05/essay_harry_potter.png" title="Don't touch me..." alt="Vhost threshold"/></p> <p>看paper是不是比较无聊的事情？</p> <p>我试着在自己看的每篇论文标题前面加上“Harry Potter and The”，要不你也试试？</p> <p>当然，更好的状态是，其实你不是因为要做某个事情在看paper，而是出于好玩。</p> <p>比如最近我看了一篇<a href="/downloads/code/2016JAHH_19_18C.pdf">paper</a>，名字叫“Seasonal Dating of Sappho’s ‘Midnight Poem’ Revisited”。</p> <p><a href="https://zh.wikipedia.org/wiki/%E8%8E%8E%E5%AD%9A">Sappho</a>作为古希腊&#8221;第十繆斯&#8221;，在国内没有多显赫的名声，能找到的只有豆瓣上一篇和她相关艺术品的<a href="https://site.douban.com/109824/widget/notes/245567/note/208098917/">介绍文章</a>。其实她的腕儿相当大，女同的称呼“lesbian”就取自她的居住地“Lesbos”。</p> <p>而这篇论文是说，如何根据Sappho下面这首诗里面的描述，来判断这首诗写作于一年里面的什么时节。</p> <blockquote><p>The Moon hath left the sky;<br/>Lost is the Pleiads&#8217; light;<br/>It is midnight<br/>And time slips by;<br/>But on my couch alone I lie.</p></blockquote> <p>其中<a href="http://earthsky.org/favorite-star-patterns/pleiades-star-cluster-enjoys-worldwide-renown">Pleiasds</a>，如果你喜欢科幻的话肯定不会陌生，就是著名的金牛座七姐妹星团：昴宿星团（阿根廷一直有一帮人号称自己是来自这个星球，但其实这个星团有数不清的恒星组成）。</p> <p>所以，Sappho她：</p> <ol> <li>住在Lesbos</li> <li>在午夜之前看到昴宿星团消失在地平线</li> </ol> <p>在这些信息的帮助下，天文学家通过<a href="http://astronomy.starrynight.com/">软件</a>重建当时的星图，来得出了以下的结论：</p> <blockquote><p>Assuming that Sappho observed from Mytilene on the island of Lesbos, we determined that in 570 BC the Pleiades set before midnight from 25 January on, and were lost to the evening twilight completely by 6 April.</p></blockquote> <p>发了paper之后，作者还<a href="http://www.eurekalert.org/pub_releases/2016-05/uota-usu051316.php">嘚瑟</a>了一下，大概是说“这种准确描述星象和时间的作品实在是少，被我们抓到（发了篇有趣的paper）哇哈哈哈”。</p> <p>的确，要比较明确地描述，你首先得认识，能做到这点的诗人可不多。比如我<a href="https://movie.douban.com/subject/2373195/">Walt H. White</a>枕边放的Walt Whitman是搞清楚了的：</p> <blockquote><p>Up through the darkness,<br/>While ravening clouds, the burial clouds, in black masses spreading,<br/>Lower sullen and fast athwart and down the sky,<br/>Amid a transparent clear belt of ether yet left in the east,<br/>Ascends large and calm the lord-star Jupiter,<br/>And nigh at hand, only a very little above,<br/>Swim the delicate sisters the Pleiades.</p></blockquote> <p>再比如我大杜甫是搞清楚了的：</p> <blockquote><p>人生不相见，动如参与商。<br/>今夕复何夕，共此灯烛光。</p></blockquote> <p>参和商两个星，没法同时出现，用来形容人生不相见算是恰如其分。</p> <p>还有流行歌选集《诗经》那些写词的是搞清楚了的：</p> <blockquote><p>七月流火，九月授衣。</p></blockquote> <p>“火”是指<a href="http://www.bud.org.tw/chen/chen0008.htm">心宿二</a>，所以“七月流火”是说这颗星逐渐<a href="http://iask.sina.com.cn/b/10608508.html">从天空中消失</a>。</p> <p>至于什么“七月流火，酷暑难耐”的用法，倒是现代人自己没有搞清楚了。</p> <div id="player1" class="aplayer"></div> <p><link rel="stylesheet" href="/downloads/static/css/APlayer.min.css"></p> <script src="/downloads/static/js/APlayer.min.js"></script> <script>
var ap1 = new APlayer ({
element: document.getElementById ('player1'),
narrow: false,
autoplay: true,
showlrc: 1,
mutex: true,
theme: '#615754',
music: {
   title: 'Vincent',
   author: 'Don Mclean',
   url: 'http://7rflrq.com1.z0.glb.clouddn.com/vincent.mp3',
   pic: 'http://7rflrq.com1.z0.glb.clouddn.com/vincent.jpeg',
   lrc: "[ar:Declan Galbraith]\n [al:Thank You]\n [00:00.00]Declan Galbraith - Vincent (Starry, Starry Night)\n [00:00.25]Starry, starry night.\n [00:05.03]Paint your palette blue and grey,\n [00:09.75]Look out on a summer's day,\n [00:13.04]With eyes that know the darkness in my soul.\n [00:17.45]Shadows on the hills,\n [00:21.92]Sketch the trees and the daffodils,\n [00:27.02]Catch the breeze and the winter chills,\n [00:30.48]In colors on the snowy linen land.\n [00:37.20]Now I understand what you tried to say to me,\n [00:46.42]How you suffered for your sanity,\n [00:51.51]How you tried to set them free.\n [00:54.58]They would not listen, they did not know how.\n [01:00.45]Perhaps they'll listen now.\n [01:05.80]Starry, starry night.\n [01:10.64]Flaming flowers that brightly blaze,\n [01:15.33]Swirling clouds in violet haze,\n [01:19.24]Reflect in Vincent's eyes of china blue.\n [01:23.71]Colors changing hue,\n [01:28.59]morning field of amber grain,\n [01:33.52]Weathered faces lined in pain,\n [01:37.15]Are soothed beneath the artist's loving hand.\n [01:42.27]Now I understand what you tried to say to me,\n [01:51.70]How you suffered for your sanity,\n [01:56.30]How you tried to set them free.\n [01:59.49]They would not listen, they did not know how.\n [02:05.17]Perhaps they'll listen now.\n [02:07.62]For they could not love you,\n [02:12.65]But still your love was true.\n [02:17.37]And when no hope was left in sight\n [02:20.99]On that starry, starry night,\n [02:24.18]You took your life, as lovers often do.\n [02:29.65]But I could have told you, Vincent,\n [02:33.61]This world was never meant for one\n [02:36.20]As beautiful as you.\n [02:42.70]Starry, starry night.\n [02:47.85]Portraits hung in empty halls,\n\n [02:52.28]Frameless head on nameless walls,\n [02:56.35]With eyes that watch the world and can't forget.\n [03:00.72]Like the strangers that you've met,\n [03:04.42]All the ragged men in the ragged clothes,\n [03:09.85]The silver thorn of bloody rose,\n [03:13.78]Lie crushed and broken on the virgin snow.\n [03:18.97]Now I think I know what you tried to say to me,\n [03:29.16]How you suffered for your sanity,\n [03:34.07]How you tried to set them free.\n [03:37.88]They would not listen, they're not listening still.\n [03:43.51]Perhaps they never will...\n"
    }
});
ap1.init();
</script> </div> </article> <article> <header> <h1 class="entry-title"><a href="/2016/05/but-does-it-float/">一天很长，十年很短</a></h1> <p class="meta"> <time class='entry-date' datetime='2016-05-18T20:50:55+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>8:50 pm</span></time> | <a href="/2016/05/but-does-it-float/#disqus_thread" data-disqus-identifier="https://lenciel.com/2016/05/but-does-it-float/">Comments</a> </p> </header> <div class="entry-content"><p><img src="/downloads/images/2016_05/ppl_5.jpg" title="Don't touch me..." alt="Vhost threshold"/></p> <p>夏天来了。</p> <p>经常让我读他的文章忍不住点头称是的Sam，在他的<a href="http://36kr.com/p/532396.html">36条人生建议</a>里面略无厘头的插了一句：“夏天是最棒的”。</p> <p>和他结尾的那句“The days are long but the decades are short”一样，充满了玄机。</p> <p>那么夏天究竟好在哪里？本座感觉，有一半要归于可以吃冰过的西瓜。</p> <p>现如今的西瓜，要不就是你挑它的时候，已经被切开了用保鲜膜封好等着你；要不就是你随随便便挑一只，小贩三下五除二切好让你拎走。</p> <p>小时候挑瓜，并不是这么着急。不管是跟大人去买，还是自己去买，都要装模作样的拍拍这个，听听那个，然后在卖瓜人的建议下庄严地选中一个，由他在那瓜皮上划出个不深不浅的三角形，挖出来看过，再把那挖出来的一块塞回去，才付钱装好带走。</p> <p>那会儿本座吃西瓜还有两个特别之处。第一是不吐籽：总有人说这样会长出点儿什么，就很不服气的想看看究竟会不会长出什么。第二是吃完一定会用瓜皮反复揉搓手背：因为那时候冬天总是满手冻疮，老妈就说了这个偏方。</p> <p>虽然弄了之后每年还是长冻疮，但这实在是世界上最舒适宜人的偏方了，所以现在吃瓜还经常要玩玩。</p> <p>夏天好在有冰西瓜，那为什么“一天很长，十年很短”？</p> <p>我觉得你到了一定年纪，又没有变得太伶俐，就总会明白。</p> <p>比如本座的今天，有收到公司签了成立以来最大一单的喜讯，也有接到长辈辞世的电话。本来就腰酸背痛，伴随着心绪不宁，还得吭哧吭哧地搞一坨坨奇葩的问题，就觉得日头好长。</p> <p>那么十年短不短呢？这两天应景在床头又读了一遍高尔泰的《寻找家园》，再想起最近和人聊起的胡适和陈衡哲，杨宪益和戴乃迭，觉得别说十年，五十年、一百年也不过弹指一挥间。</p> <p>所以说《后汉书•襄楷传》里面有一段说延熹九年楷上疏极谏：</p> <blockquote><p>有云：“或言老子入夷狄为浮屠，浮屠不三宿桑下，不欲久生恩爱，精之至也。”章怀太子注曰：“言浮屠之人寄桑下者不经三宿，便即移去，示无爱恋之心也。”</p></blockquote> <p></p> <p>周作人读了之后大概是对这种<code>不经三宿，便即移去，示无爱恋之心</code>颇为不满，所以把自己的集子取名叫《桑下谈》，还在序中说道：</p> <blockquote><p>浮屠应当那样做，我们凡人是不可能亦并无须，但他们怕久生恩爱，这里边很有人情，凡不是修道的人当从反面应用，即宿于桑下便宜有爱恋是也。本来所谓恩爱并不一定要是怎么急迫的关系，实在也还是一点情分罢了。住世多苦辛，熟习了亦不无可留连处，水与石可，桑与梓亦可，即鸟兽亦可也，或薄今人则古人之言与行亦复可凭吊，此未必是怀旧，盖正是常情耳。语云，一树之荫亦是缘分。若三宿而起，掉头迳去，此不但为俗语所讥，即在浮屠亦复不情，他们不欲生情以损道心。正因不能乃尔薄情也。</p></blockquote> <p></p> <p>的确，世界上到处是荒谬和残酷，丑多于美，苦多于乐，并且今天这样，明天还会继续这样。但即使如此，对人生际遇动不动就消极对待怨天尤人，或者动不动就斩钉截铁地要诀别的人，总是让人觉得活得目的性强了一些。</p> <p>当然，宿于桑下便宜有爱恋，确实不是人人都需要的生活态度。就好像《西游记》里面最后一回：</p> <blockquote><p>说八大金刚使了第二阵香风，把三藏师徒四人，送到了东土，渐渐望见长安。金刚停在空中，叫道：“圣僧，此间乃长安城了。我们不好下去，这里人伶俐……”</p></blockquote> <p></p> <p>圣僧面对伴着自己走过一场荒凉旅程，如此谦卑的金刚，既没有拱手，也没有敛身，更别说道声谢谢。如果是“悄悄问圣僧，女儿美不美”的局面，师傅你大概不会这么没有EOF。</p> <p>你们大多数人类，还是太伶俐了。</p> </div> </article> <article> <header> <h1 class="entry-title"><a href="/2016/05/the-exciting-writings/">一颗赛艇</a></h1> <p class="meta"> <time class='entry-date' datetime='2016-05-06T04:26:09+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>4:26 am</span></time> | <a href="/2016/05/the-exciting-writings/#disqus_thread" data-disqus-identifier="https://lenciel.com/2016/05/the-exciting-writings/">Comments</a> </p> </header> <div class="entry-content"><p><img src="/downloads/images/2016_05/jpm.jpg" title="Don't touch me..." alt="Vhost threshold"/></p> <p>昨天立夏，闷热异常，晚上终于来了几声雷，却是雷声大雨点小。</p> <p>到了半夜，突然热闹起来。大雨不懈，夜风也疾，白筋鞭窗，噼啪不止。</p> <p>我在客厅里伴着这电闪雷鸣写程序，场面看起来应该多少有些一颗赛艇。</p> <p>如果不是键盘敲得太响，有绰约的女鬼来袭也说不定。</p> <p>社会主义国家家长们都不怎么讲鬼故事，本座对鬼的印象一开始来自书：虽然《西游记》连续剧里面各式各样的鬼怪很多，但因为形象太具体，反而不会觉得他们有多鬼，看过就不会去想。而书里面要精彩很多：子路和孔子除开创办Subway，还讨论怪力乱神；迅哥儿说起保姆跟《山海经》，头头是道；《聊斋》里面的狐狸系最丰富多彩，特别是在表哥还是表姐家里找到的那本未删节的，多少个夜晚，一颗赛艇。</p> <p>到了王祖贤的小倩和张曼玉的青蛇出现，女鬼可爱程度突然达到了顶峰，同时也让人明白之前电视里的鬼不招人惦记，并不是因为形象太具体了。可惜好景不长，日韩女鬼不远万里来袭：这些女鬼，就真的有些吓人了。</p> <p>再到了大学，鬼的来源又丰富了些。贾平凹的各种鬼，莫言的各种鬼，张爱玲的小红人，但这些鬼虽然生动，却不那么浪漫了。</p> <p>一颗赛艇的内容，还是跟鬼没有关系的书里面多一些。</p> <p>而作为一名还算看过些书的同学，本座得说，大概是因为古往今来大多数中国人这方面比较压抑，写作水平整体偏低（这方面不压抑的都不会沦为作家吧）。表现在白描太多，暗示太少，偶尔臆想一下，鲁莽粗俗，一点儿幽默感都没有。相比之下，大概神仙们就比较乱来，西方文学作品里咸湿的地方一直相当咸湿（有人专门研究莎士比亚的这方面还写了《<a href="https://www.amazon.com/Filthy-Shakespeare-Shakespeares-Outrageous-Sexual-ebook/dp/B002XW28D0?ie=UTF8&amp;btkr=1&amp;ref_=dp-kindle-redirect">Filthy Shakespeare</a>》），不说男女之情，连同性的爱情也写得相当感人。当然，你只要看过电影《莎翁情史》（这部电影给本座的另外一个感受就是Gwyneth Paltrow确实不是Chris Martin能hold住的）就会明白这主要还是日子过得不一样。</p> <p>比如说到这方面绕不过去的《金瓶梅》，连太祖这样的“仙人洞，在险峰”路数的选手都批评作者<a href="http://history.sohu.com/20150911/n420836423.shtml">对女性角色缺乏善意</a>。但是你要明白，《金瓶梅》就算非常不错的水准了，太祖可是翻来覆去地看，如果有豆瓣，书评至少提交五次。而不幸出生在南京传教士家庭的《金瓶梅》英译版作者芮效卫一翻就是40年，按<a href="http://news.inewsweek.cn/detail-634.html">介绍里面</a>说，从17岁拿起《金瓶梅》就再也没放下：如果是在国外，大概并不需要放不下它吧。</p> <p>再比如说到这方面绕不过去的贾平凹老师，一部小说至少十来句“下面湿了”，湿是湿了，还不如树新风足球队“最近下面有点儿咸你要不要吃”好玩。</p> <p>因为这方面很残，中国的故事里面很少有被爱一方可以好好欣赏对方可爱之处的设定：无论是西门庆潘金莲，还是白娘子祝英台，爱恋的对象要么异常淫荡，要么非常无趣。</p> <p>但咱们也有例外。</p> <p>比如汤显祖老师的《牡丹亭》。</p> <p>有掉书袋的：</p> <blockquote><p>“他倚太湖石，立着咱玉婵娟。待把俺玉山推倒，便日暖玉生烟。捱过雕栏，转过秋千，掯着裙花展。敢席着地，怕天瞧见。好一会，分明美满，幽香不可言！”</p></blockquote> <p>有很市井的：</p> <blockquote><p>“见了你紧相偎，慢厮连，恨不得和你肉儿般团成片也，逗的个日下胭脂雨上鲜。”</p></blockquote> <p>有非常直白的：</p> <blockquote><p>“无多，花影阿那。劝奴奴睡也，睡也奴哥。春宵美满，一霎暮钟敲破。娇娥，似前宵云雨羞怯讹，敢今夜翠颦轻可。睡则那，把腻乳微搓，酥胸汗帖，细腰春锁。”</p></blockquote> <p>也有非常暗示的：</p> <blockquote><p>“他兴心儿紧咽咽，呜着咱香肩；俺可也慢掂掂做意儿周旋，周旋。等闲间把一个照人儿昏善。这般形现，那般软绵，忒见一片撒花心的红叶儿吊将来半天，吊将来半天。敢是咱梦魂儿厮纒？”</p></blockquote> <p>是不是让你觉得“自小孤单，生事微渺，每日情思昏昏”的柳梦梅过得还不错。</p> <p>咦，女鬼还没来，天就亮了？</p> </div> </article> <div class="pagination"> <a class="prev" href="/posts/2">&larr; Older</a> <a href="/blog/archives">Blog Archives</a> </div> </div> <aside class="sidebar"> </aside> </div> </div> <footer role="contentinfo"><p> Blog theme: <a href="https://github.com/lenciel/octopress-theme-lenciel">Octopress-Lenciel 0.1</a> <span class="theme-version">Copyright &copy; 2016 - Lenciel Li</span> <section class="contruction-wrap"> <div class="contruction"></div> </section> </p> </footer> <script type="text/javascript">
      var disqus_shortname = 'lencielgithub';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script> <script type="text/javascript">
  var stylesheet = document.createElement('link');
  stylesheet.href = '/stylesheets/screen.css';
  stylesheet.rel = 'stylesheet';
  stylesheet.type = 'text/css';
  document.getElementsByTagName('head')[0].appendChild(stylesheet);
</script> <script type="text/javascript">
  var stylesheet = document.createElement('link');
  stylesheet.href = '/stylesheets/data-table.css';
  stylesheet.rel = 'stylesheet';
  stylesheet.type = 'text/css';
  document.getElementsByTagName('head')[0].appendChild(stylesheet);
</script> </body> </html>